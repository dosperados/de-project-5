Добрый день, меня зовут Виталий.
Спасибо за замечания!
1. замечание по файлу src/dag/stg_fetch_files_from_s3.py - да подскажи как лучше и правильнее сделать такой вывод в DAG.
2. исправил DAG src/dag/stg_migration.py сделал старт и стоп через DummyOperator.
3. хочу обсудить твое замечание к файлу src/dag/ddl_change_schema.sql
  > datetime это служебный тип данных! Плохая практика использовать типы данных как название чего-либо, не только в sql. Давай переименуем этот столбец во что-нибудь другое и присвоим ему тип datetime
Мои аргументы: Это таблица в STAGING зоне и содержит данные "AS IS" как в источнике. Считаю, что не правильно изменеять структуру таблиц в STAGING чтобы она отличалась от источника.
Поясни, если я что-то не правильно понимаю.
4. хочу обсудить твое второе замечание к файлу src/dag/ddl_change_schema.sql
  > Давай сделаем партицированние и группировку по другому полю, чтобы получить наиболее точный результат!
Мои мысли: я хотел сделать витрину в новой схеме "cdm", но к сожалению нет доступа в Vertica создавать новые схемы. Данная таблица (по условиям бизнесс задачи) содержит всего 10 записей.
Поэтому предлагаю сделать партиционирование и группировку по полю load_dt - тогда все 10 строк будут находится на одной ноде и в одной партиции.
Для таблицы с таким количеством записей не вижу смысла в другом виде группировки и партиционировании.
